# Production Environment Configuration for RAGFlow

# Environment
ENVIRONMENT=production
DEBUG=false
TESTING=false

# Server Configuration
HOST=0.0.0.0
PORT=8000
WORKERS=4
MAX_REQUESTS=1000
MAX_REQUESTS_JITTER=100

# Database Configuration
DATABASE_URL=postgresql://ragflow_user:${DB_PASSWORD}@postgres:5432/ragflow_prod
DATABASE_POOL_SIZE=20
DATABASE_MAX_OVERFLOW=30
DATABASE_POOL_TIMEOUT=30
DATABASE_POOL_RECYCLE=3600

# Redis Configuration
REDIS_URL=redis://redis:6379/0
REDIS_MAX_CONNECTIONS=50
REDIS_SOCKET_KEEPALIVE=true
REDIS_SOCKET_KEEPALIVE_OPTIONS={}

# Elasticsearch Configuration
ELASTICSEARCH_URL=http://elasticsearch:9200
ELASTICSEARCH_MAX_RETRIES=3
ELASTICSEARCH_TIMEOUT=30

# MinIO Configuration
MINIO_ENDPOINT=minio:9000
MINIO_ACCESS_KEY=${MINIO_ACCESS_KEY}
MINIO_SECRET_KEY=${MINIO_SECRET_KEY}
MINIO_BUCKET_NAME=ragflow-documents
MINIO_SECURE=false

# Security Configuration
SECRET_KEY=${SECRET_KEY}
JWT_SECRET_KEY=${JWT_SECRET_KEY}
JWT_ALGORITHM=HS256
JWT_EXPIRE_MINUTES=1440
CORS_ORIGINS=["https://yourdomain.com", "https://api.yourdomain.com"]

# Logging Configuration
LOG_LEVEL=INFO
LOG_FORMAT=json
LOG_FILE_ENABLED=true
LOG_FILE_PATH=/app/logs/ragflow.log
LOG_FILE_MAX_SIZE=50MB
LOG_FILE_BACKUP_COUNT=10

# Performance Configuration
CACHE_TTL=3600
CACHE_MAX_SIZE=512MB
EMBEDDING_CACHE_TTL=86400
LLM_CACHE_TTL=7200

# Concurrency Limits
MAX_CONCURRENT_DOCUMENT_PROCESSING=8
MAX_CONCURRENT_EMBEDDING_GENERATION=16
MAX_CONCURRENT_SEARCH_REQUESTS=32
MAX_CONCURRENT_LLM_REQUESTS=6

# Model Configuration
YANDEX_API_KEY=${YANDEX_API_KEY}
YANDEX_FOLDER_ID=${YANDEX_FOLDER_ID}
EMBEDDING_MODEL=text-search-doc/latest
LLM_MODEL=yandexgpt/latest

# External Services
TAVILY_API_KEY=${TAVILY_API_KEY}
ENABLE_EXTERNAL_SEARCH=true

# Monitoring Configuration
ENABLE_METRICS=true
METRICS_PORT=9090
HEALTH_CHECK_INTERVAL=30
PERFORMANCE_MONITORING=true

# File Processing Configuration
MAX_FILE_SIZE=100MB
SUPPORTED_FILE_TYPES=["pdf", "docx", "xlsx", "txt", "md", "html", "json"]
TEMP_DIR=/app/tmp
MODELS_DIR=/app/models

# DeepDoc Configuration
DEEPDOC_ENABLED=true
DEEPDOC_MODEL_CACHE_DIR=/app/models
DEEPDOC_BATCH_SIZE=4
DEEPDOC_MAX_IMAGE_SIZE=2048

# Chunking Configuration
DEFAULT_CHUNK_SIZE=512
DEFAULT_CHUNK_OVERLAP=50
MAX_CHUNKS_PER_DOCUMENT=1000

# Search Configuration
DEFAULT_SEARCH_TOP_K=10
MAX_SEARCH_RESULTS=100
SEARCH_TIMEOUT=30

# Citation Configuration
CITATION_MIN_CONFIDENCE=0.7
CITATION_MAX_PER_SENTENCE=3
CITATION_VALIDATION_ENABLED=true

# Knowledge Graph Configuration
KG_ENABLED=true
KG_ENTITY_EXTRACTION_BATCH_SIZE=10
KG_RELATION_EXTRACTION_BATCH_SIZE=5
KG_COMMUNITY_DETECTION_ENABLED=true

# Task Execution Configuration
TASK_QUEUE_SIZE=1000
TASK_RETRY_ATTEMPTS=3
TASK_TIMEOUT=300
TASK_HEARTBEAT_INTERVAL=30

# Resource Limits
MEMORY_LIMIT=4GB
CPU_LIMIT=4
DISK_SPACE_LIMIT=100GB

# Backup Configuration
BACKUP_ENABLED=true
BACKUP_SCHEDULE="0 2 * * *"  # Daily at 2 AM
BACKUP_RETENTION_DAYS=30

# SSL/TLS Configuration
SSL_ENABLED=false
SSL_CERT_PATH=/app/certs/cert.pem
SSL_KEY_PATH=/app/certs/key.pem

# Rate Limiting
RATE_LIMIT_ENABLED=true
RATE_LIMIT_REQUESTS_PER_MINUTE=100
RATE_LIMIT_BURST=20

# Feature Flags
ENABLE_AGENTIC_SEARCH=true
ENABLE_RAPTOR_CLUSTERING=true
ENABLE_ADVANCED_CHUNKING=true
ENABLE_CITATION_VALIDATION=true
ENABLE_KNOWLEDGE_GRAPH=true